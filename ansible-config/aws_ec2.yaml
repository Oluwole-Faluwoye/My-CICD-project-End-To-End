plugin: amazon.aws.aws_ec2

regions:
  - us-east-1
  - us-east-2

# Fetch all running Tomcat instances
filters:
  "tag:Role": "Tomcat"
  "instance-state-name": "running"

# Group hosts dynamically by Environment tag
keyed_groups:
  - key: tags.Environment
    prefix: tag_Environment
    separator: "_"

# Use private IPs for Ansible connections
hostnames:
  - private-ip-address

# Compose ansible_host variable
compose:
  ansible_host: private-ip-address

# Optional: connect using ansibleadmin
# ansible_user: ansibleadmin
# ansible_ssh_pass: "{{ lookup('env','ANSIBLE_ADMIN_PASS') }}"
